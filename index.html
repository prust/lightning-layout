<html>
  <head>
    <title>Canvas Boilerplate</title>
    <!-- from http://weworkweplay.com/play/retinafy-your-canvas/ -->
    <style type="text/css">
      *,html{
        margin: 0;padding: 0;
      }
      canvas { 
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body onload="setup();">
    <canvas id="canvas"></canvas>
    <script type="text/javascript">

      var global_width = window.innerWidth,
          global_height = window.innerHeight,
          ratio = 1,
          canvas = document.getElementById('canvas'),
          ctx = canvas.getContext('2d');

      function setup() {
        init();
        requestAnimationFrame(update);
        addEventListener('resize', rescale);
        rescale();
      }

      function rescale(){
        global_width = window.innerWidth;
        global_height = window.innerHeight;
        if (ctx.webkitBackingStorePixelRatio < 2)
          ratio = window.devicePixelRatio || 1;
        canvas.setAttribute('width', global_width*ratio);
        canvas.setAttribute('height', global_height*ratio);
        draw();
      }

      function init() {
        draw();
      }

      function drawWidget(widget, parent_x1, parent_y1, parent_x2, parent_y2) {
        var x1 = parent_x1;
        var y1 = parent_y1;
        var x2 = parent_x2;
        var y2 = parent_y2;
        
        if (widget.top)
          y1 += widget.top;
        if (widget.left)
          x1 += widget.left;
        
        if (widget.text) {
          ctx.font = 'bold 12pt arial';
          var metrics = ctx.measureText(widget.text);
          metrics.height = 12;
        }

        var padding = widget.padding || 0;

        if (widget.bottom)
          y2 -= widget.bottom;
        else if (widget.height)
          y2 = y1 + widget.height;
        else if (metrics)
          y2 = y1 + metrics.height + padding * 2;

        if (widget.right)
          x2 -= widget.right;
        else if (widget.width)
          x2 = x1 + widget.width;
        else if (metrics)
          x2 = x1 + metrics.width + padding * 2;

        if (widget.backgroundColor) {
          ctx.fillStyle = widget.backgroundColor;
          ctx.fillRect(x1, y1, x2-x1, y2-y1);
        }

        if (widget.borderColor) {
          ctx.strokeStyle = widget.borderColor;
          ctx.lineWidth = widget.borderWidth;
          ctx.strokeRect(x1, y1, x2-x1, y2-y1);
        }

        if (widget.text) {
          ctx.fillStyle = widget.color;
          ctx.fillText(widget.text, x1 + padding, y1 + metrics.height + padding);
        }

        if (widget.children) {
          widget.children.forEach(function(child) {
            drawWidget(child, x1, y1, x2, y2);
          });
        }
      }

      function draw(){
        ctx.save();
        ctx.scale(ratio, ratio);

        drawWidget(layout2, 0, 0, global_width * ratio, global_height * ratio);
        ctx.restore();
      }

      function update(){ 
        requestAnimationFrame(update);
      }

      var layout1 = {
        backgroundColor: "#2C425C",
        width: 200,
        height: 200,
        color: "#FFFFFF",
        children: [{
          backgroundColor: "#6BFEF2",
          color: "#32363B",
          text: "Hello World"
        }]
      };

      var layout2 = {
        backgroundColor: "#2C425C",
        width: 200,
        height: 200,
        color: "#FFFFFF",
        children: [{
          borderColor: "red",
          borderWidth: 2,
          backgroundColor: "#6BFEF2",
          padding: 10,
          color: "#32363B",
          text: "Hello World"
        }]
      };
    </script>
  </body>
</html>