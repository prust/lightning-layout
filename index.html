<html>
  <head>
    <title>Canvas Boilerplate</title>
    <style type="text/css">
      *,html{
        margin: 0; padding: 0;
      }
      canvas { 
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body onload="setup();">
    <canvas id="canvas"></canvas>
    <script type="text/javascript">

      var global_width = window.innerWidth,
          global_height = window.innerHeight,
          ratio = getRatio(),
          canvas = document.getElementById('canvas'),
          ctx = canvas.getContext('2d');

      function setup() {
        addEventListener('resize', rescale);
        rescale();
        requestAnimationFrame(update);
      }

      function rescale() {
        global_width = window.innerWidth;
        global_height = window.innerHeight;
        ratio = getRatio();
        canvas.width = global_width * ratio;
        canvas.height = global_height * ratio;
        canvas.style.width = global_width + "px";
        canvas.style.height = global_height + "px";
      }

      function drawWidget(widget, parent_x1, parent_y1, parent_x2, parent_y2) {
        var x1 = parent_x1;
        var y1 = parent_y1;
        var x2 = parent_x2;
        var y2 = parent_y2;
        
        if (widget.top != null)
          y1 += widget.top;
        else if (widget.bottom != null && widget.height != null)
          y1 = y2 - widget.bottom - widget.height;
        if (widget.left != null)
          x1 += widget.left;
        
        if (widget.text) {
          ctx.font = 'bold 12pt arial';
          var metrics = ctx.measureText(widget.text);
          metrics.height = 12;
        }

        var padding = widget.padding || 0;

        if (widget.bottom != null)
          y2 -= widget.bottom;
        else if (widget.height != null)
          y2 = y1 + widget.height;
        else if (metrics)
          y2 = y1 + metrics.height + padding * 2;

        if (widget.right != null)
          x2 -= widget.right;
        else if (widget.width != null)
          x2 = x1 + widget.width;
        else if (metrics != null)
          x2 = x1 + metrics.width + padding * 2;

        if (widget.backgroundColor) {
          ctx.fillStyle = widget.backgroundColor;
          ctx.fillRect(x1, y1, x2-x1, y2-y1);
        }

        if (widget.borderColor) {
          ctx.strokeStyle = widget.borderColor;
          ctx.lineWidth = widget.borderWidth;
          ctx.strokeRect(x1, y1, x2-x1, y2-y1);
        }

        if (widget.text) {
          ctx.fillStyle = widget.color;
          ctx.fillText(widget.text, x1 + padding, y1 + metrics.height + padding);
        }

        if (widget.children) {
          widget.children.forEach(function(child) {
            drawWidget(child, x1 + padding, y1 + padding, x2 - padding, y2 - padding);
          });
        }
      }

      function update() {
        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
        drawWidget(layout2, 0, 0, global_width, global_height);
        requestAnimationFrame(update);
      }

      function getRatio() {
          var ctx = document.createElement("canvas").getContext("2d"),
              dpr = window.devicePixelRatio || 1,
              bsr = ctx.webkitBackingStorePixelRatio ||
                    ctx.mozBackingStorePixelRatio ||
                    ctx.msBackingStorePixelRatio ||
                    ctx.oBackingStorePixelRatio ||
                    ctx.backingStorePixelRatio || 1;

          return dpr / bsr;
      }

      var layout1 = {
        backgroundColor: "#2C425C",
        width: 200,
        height: 200,
        color: "#FFFFFF",
        children: [{
          backgroundColor: "#6BFEF2",
          color: "#32363B",
          text: "Hello World"
        }]
      };

      var layout2 = {
        backgroundColor: "#2C425C",
        height: 200,
        bottom: 0,
        color: "#FFFFFF",
        children: [{
          borderColor: "red",
          borderWidth: 2,
          backgroundColor: "#6BFEF2",
          padding: 10,
          color: "#32363B",
          text: "Hello World"
        }]
      };
    </script>
  </body>
</html>